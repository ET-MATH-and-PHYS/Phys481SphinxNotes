

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Ising model &mdash; Phys481SphinxNotes 1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/fonts.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/fonts.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Phys481SphinxNotes
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../LectureNotes.html"><strong>Phys 481 Lecture Notes</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tasks.html"><strong>Daily Tasks</strong></a></li>
</ul>
<p class="caption"><span class="caption-text">Jupyter Notebooks:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="phys481_week00_example_report_template.html">Example notebook report template</a></li>
<li class="toctree-l1"><a class="reference internal" href="phys481_week01_cat_shuffle-notes.html">Shuffling Arnold’s Cat</a></li>
<li class="toctree-l1"><a class="reference internal" href="phys481_week02a_spamlet_entropy-notes.html">Bernoulli, entropy and spamlet</a></li>
<li class="toctree-l1"><a class="reference internal" href="phys481_week02b_integer%2Cfloat-notes.html">Numbers: integers, fixed point and floating point</a></li>
<li class="toctree-l1"><a class="reference internal" href="phys481_week03a_computing_past_present_future.html">What are we doing here?</a></li>
<li class="toctree-l1"><a class="reference internal" href="phys481_week03a_automata_life-notes.html">Phys481 notes - Automata and Life</a></li>
<li class="toctree-l1"><a class="reference internal" href="phys481_week04b_pseudorandom-notes.html">Pseudo-random number generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="phys481_week04b_automata_entropy-notes.html">PHYS 481 - Automata entropy</a></li>
<li class="toctree-l1"><a class="reference internal" href="phys481_week08_laplace_equation-notes.html">Laplace equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="phys481_week08b_physical_units_constants-notes.html">Physical constants and units</a></li>
<li class="toctree-l1"><a class="reference internal" href="phys481_week09a_laplace_linear_algebra-notes.html">Laplace equation - matrix methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="phys481_week09b_fourier_audio-notes.html">Fourier transforms and audio</a></li>
</ul>
<p class="caption"><span class="caption-text">D2L Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../RockStar.html"><strong>Rockstar Programming and Teamwork</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../SphinxDocs.html"><strong>Sphinx Documentation</strong></a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Phys481SphinxNotes</a>
        
      </nav>


      <div class="wy-nav-content">
<div class="git-ribbon">
  <a href="http://github.com/SwissDataScienceCenter" rel="me">Join us on GitHub</a>
</div>

        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Ising model</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/JupyterNotes/phys481_week06_ising_model-notes.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Ising-model">
<h1>Ising model<a class="headerlink" href="#Ising-model" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Ising_model">https://en.wikipedia.org/wiki/Ising_model</a></p>
<p>The Ising model, named after the physicist Ernst Ising, is a mathematical model of ferromagnetism in statistical mechanics. The model consists of discrete variables that represent magnetic dipole moments of atomic spins that can be in one of two states (<span class="math notranslate nohighlight">\(+1\)</span> or <span class="math notranslate nohighlight">\(-1\)</span>). The spins are arranged in a graph, usually a lattice, allowing each spin to interact with its neighbors. The model allows the identification of phase transitions, as a simplified model of reality. The two-dimensional
square-lattice Ising model is one of the simplest statistical models to show a phase transition.</p>
<p>The Ising model was invented by the physicist Wilhelm Lenz (1920), who gave it as a problem to his student Ernst Ising. The one-dimensional Ising model has no phase transition and was solved by Ising (1925) himself in his 1924 thesis. The two-dimensional square lattice Ising model is much harder, and was given an analytic description much later, by Lars Onsager (1944). It is usually solved by a transfer-matrix method, although there exist different approaches, more related to quantum field
theory.</p>
<p><a class="reference external" href="http://farside.ph.utexas.edu/teaching/329/lectures/node110.html">http://farside.ph.utexas.edu/teaching/329/lectures/node110.html</a></p>
<p><a class="reference external" href="https://www.natur.cuni.cz/chemie/fyzchem/nachtig/prednaskst/Eng_Lecture_11.pdf">https://www.natur.cuni.cz/chemie/fyzchem/nachtig/prednaskst/Eng_Lecture_11.pdf</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="section" id="Dipole-energy">
<h2>Dipole energy<a class="headerlink" href="#Dipole-energy" title="Permalink to this headline">¶</a></h2>
<p>It can be shown that the energy <span class="math notranslate nohighlight">\(U\)</span> required to align a magnetic dipole <span class="math notranslate nohighlight">\(m\)</span> in a magnetic field <span class="math notranslate nohighlight">\(B\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[U = - \vec m \cdot \vec B = - m B \cos\theta\]</div>
<p>where <span class="math notranslate nohighlight">\(\theta\)</span> is the angle between the dipole moment and field directions. The lowest potential energy configuration occurs if they are parallel</p>
<div class="math notranslate nohighlight">
\[U = - m B\]</div>
<p>while the largest amount of potential energy is stored in the system if the dipole and field are pointing in opposite directions</p>
<div class="math notranslate nohighlight">
\[U = + m B\]</div>
</div>
<div class="section" id="Boltzman-distribution">
<h2>Boltzman distribution<a class="headerlink" href="#Boltzman-distribution" title="Permalink to this headline">¶</a></h2>
<p>If a small system is in thermal equilibrium with a large “heat-sink” of temperature T, then the probability of state <span class="math notranslate nohighlight">\(\mathbf x\)</span> for the small system will follow a Boltzmann distribution which is an exponential function of the ratio of energy (E) to temperature</p>
<div class="math notranslate nohighlight">
\[p(\mathbf x) \propto \exp \left(-\frac{E(\mathbf x)}{k_B T}\right)\]</div>
<p>and <span class="math notranslate nohighlight">\(k_B\)</span> is the Boltzmann constant</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1.380649×10−23  J⋅K−1
8.617333262145×10−5 eV⋅K−1
</pre></div>
</div>
<p>Consider the simplest possible case of two states with energies <span class="math notranslate nohighlight">\(E_1\)</span> and <span class="math notranslate nohighlight">\(E_2\)</span>. The probabilities have an exponential dependence on energy</p>
<div class="math notranslate nohighlight">
\[p_1 \propto \exp \left(-\frac{E_1}{k_B T}\right)\]</div>
<div class="math notranslate nohighlight">
\[p_2 \propto \exp \left(-\frac{E_2}{k_B T}\right)\]</div>
<p>which means that the relative probability of two different states</p>
<div class="math notranslate nohighlight">
\[r = \frac{p_f}{p_i} \propto e^{(E_2-E_1)/k_B T}  = \exp\frac{\Delta E}{k_B T}\]</div>
<p>is an exponential function of the <em>energy difference</em></p>
<div class="math notranslate nohighlight">
\[\Delta E = E_2 - E_1\]</div>
<p>.</p>
<p>It is important to note that these probabilities are un-normalized (don’t add up to one).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># !!NOTE!! if we just want to see the shape of this function</span>
<span class="c1">#          then we can set the Boltzmann constant to 1.0, which</span>
<span class="c1">#          is equivalent to working with energy units of $J / k_B$</span>
<span class="c1">#</span>
<span class="n">kboltz</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy  [ J / $k_B$ ]&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Probability&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Boltzmann distribution&quot;</span><span class="p">)</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">T</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">E</span><span class="o">/</span><span class="n">T</span><span class="p">),</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;T=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/JupyterNotes_phys481_week06_ising_model-notes_5_0.png" src="../_images/JupyterNotes_phys481_week06_ising_model-notes_5_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Temperature  [ K ]&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Probability&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Boltzmann distribution&quot;</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">E</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">E</span><span class="o">/</span><span class="n">T</span><span class="p">),</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;E=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">E</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Energy  [ $J / k_B$] &#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/JupyterNotes_phys481_week06_ising_model-notes_6_0.png" src="../_images/JupyterNotes_phys481_week06_ising_model-notes_6_0.png" />
</div>
</div>
</div>
<div class="section" id="Partition-function">
<h2>Partition function<a class="headerlink" href="#Partition-function" title="Permalink to this headline">¶</a></h2>
<p>A normalization constant <span class="math notranslate nohighlight">\(\mathcal C\)</span> can be determined by using the fact that the total of all probabilities must sum to 1</p>
<div class="math notranslate nohighlight">
\[\sum\limits_{n=1}^{N} p_n = 1\]</div>
<p>For the two spin system this gives</p>
<div class="math notranslate nohighlight">
\[\mathcal C\, \exp \left(-\frac{E_1}{k_B T}\right) + \mathcal C\, \exp \left(-\frac{E_2}{k_B T}\right) = 1\]</div>
<p>so</p>
<div class="math notranslate nohighlight">
\[ \mathcal C = \frac{1}{e^{\left( -\frac{E_1}{k_B T} \right)}
+ e^{\left( -\frac{E_2}{k_B T} \right)}}\]</div>
<p>It will be more convenient to work with the reciprocal of this constant</p>
<div class="math notranslate nohighlight">
\[ \mathcal Z = e^{\left( -\frac{E_1}{k_B T} \right)}
+ e^{\left( -\frac{E_2}{k_B T} \right)}\]</div>
<p>which is also known as the “partition function” <span class="math notranslate nohighlight">\(\mathcal Z(T; E_j)\)</span>. This allows us to express the normalized probabilities as</p>
<div class="math notranslate nohighlight">
\[p_n = \frac{1}{\mathcal Z}\, \exp \left(-\frac{E_n}{k_B T}\right)\]</div>
</div>
<div class="section" id="\beta-\propto-1/T">
<h2><span class="math notranslate nohighlight">\(\beta \propto 1/T\)</span><a class="headerlink" href="#\beta-\propto-1/T" title="Permalink to this headline">¶</a></h2>
<p>For further convenience, we can define a new physical quantity</p>
<div class="math notranslate nohighlight">
\[\beta = \frac{1}{k_B T}\]</div>
<p>which is inversely proportional to temperature so that</p>
<div class="math notranslate nohighlight">
\[p_n = \frac{e^{-\beta E_n}}{\mathcal Z}\]</div>
</div>
<div class="section" id="Monte-Carlo">
<h2>Monte Carlo<a class="headerlink" href="#Monte-Carlo" title="Permalink to this headline">¶</a></h2>
<p>The behavior of a single dipole in thermal equilibrium with an external field will depend on quantum mechanics, electrodynamics, and statistical physics. However, it is also possible to gain some physical insight using very simple models.</p>
<p>We can start with a cellular automaton approach using a single element. At each time step the state may be either +1 (up) or -1 (down).</p>
<p>However, physics requires that the sequence of states must also be consistent with a Boltzmann probability distribution.</p>
<div class="section" id="Gibbs-sampling">
<h3>Gibbs sampling<a class="headerlink" href="#Gibbs-sampling" title="Permalink to this headline">¶</a></h3>
<p>Consider two spin states with energies <span class="math notranslate nohighlight">\(E_+ = +E\)</span> and <span class="math notranslate nohighlight">\(E_-=-E\)</span></p>
<div class="math notranslate nohighlight">
\[\Delta E = E_+ - E_- = 2E\]</div>
<p>For simplicity, we will study a magnetic dipole with <span class="math notranslate nohighlight">\(m=1\)</span>. For a magnetic field <span class="math notranslate nohighlight">\(B\)</span> the higher energy configuration is</p>
<div class="math notranslate nohighlight">
\[E_+ = +mB\]</div>
<p>and a lower energy configuration is</p>
<div class="math notranslate nohighlight">
\[E_- = -mB\]</div>
<p>with <span class="math notranslate nohighlight">\(\Delta E = 2 m B\)</span>.</p>
<p>It is relatively simple to calculate the partition function</p>
<div class="math notranslate nohighlight">
\[ \mathcal Z = e^{\left( -\frac{E}{k_B T} \right)}
+ e^{\left( +\frac{E}{k_B T} \right)}\]</div>
<p>and probabilities</p>
<div class="math notranslate nohighlight">
\[ p_+ =\frac{\exp \left( -\frac{E}{k_B T} \right)}{e^{\left( -\frac{E}{k_B T} \right)}
+ e^{\left( +\frac{E}{k_B T} \right)}}
= \frac{1}{1 + \exp \left(-\beta \Delta E \right)}\]</div>
<div class="math notranslate nohighlight">
\[p_- = \frac{1}{1 + \exp(+\beta \Delta E )}\]</div>
<p>and use them to generate random sequences that have the desired statistics</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>state = np.random.choice([-1, +1], p=[p1,p2])
</pre></div>
</div>
</div>
</div>
<div class="section" id="Many-independent-states">
<h2>Many independent states<a class="headerlink" href="#Many-independent-states" title="Permalink to this headline">¶</a></h2>
<p>Consider a collection of <span class="math notranslate nohighlight">\(N\)</span> independent dipoles with <span class="math notranslate nohighlight">\(m=1\)</span> (so state <span class="math notranslate nohighlight">\(S=\pm 1\)</span>) in an external magnetic field <span class="math notranslate nohighlight">\(B\)</span>. The energy associated with the entire system is given by</p>
<div class="math notranslate nohighlight">
\[E = -B \sum_k S_k\]</div>
<p>Note: for convenience we will set <span class="math notranslate nohighlight">\(k_B = 1\)</span> for the next few steps.</p>
<p>For example, with 2 independent distinguishable dipoles there are 4 possible states</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> S1  S2   Energy  Probability (un-normalized)
+1  +1   -2B      exp(+beta 2B)
+1  -1    0B      1
-1  +1    0B      1
-1  -1    2B      exp(-beta 2B)
</pre></div>
</div>
<p>but only 3 unique energy configurations.</p>
<p>The partition function is given by</p>
<div class="math notranslate nohighlight">
\[\mathcal Z = \exp(-2B \beta) + 2 \exp(0) + \exp(+2B \beta)\]</div>
<div class="math notranslate nohighlight">
\[p_i = \frac{e^{-E/T}}{\mathcal Z}\]</div>
<p>state = np.random.choice([(+1,+1),(+1,-1),(-1,+1),(-1,-1)], p=[p1,p2,p3,p4])</p>
<p>For <span class="math notranslate nohighlight">\(N\)</span> binary elements there will be <span class="math notranslate nohighlight">\(2^N\)</span> configurations. Applying the Gibb’s sampler will become computationally challenging long before we reach Avagadro’s number.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># NOTE</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;(+1,+1)&#39;</span><span class="p">,</span><span class="s1">&#39;(+1,-1)&#39;</span><span class="p">,</span><span class="s1">&#39;(-1,+1)&#39;</span><span class="p">,</span><span class="s1">&#39;(-1,-1)&#39;</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([&#39;(+1,+1)&#39;, &#39;(+1,-1)&#39;, &#39;(-1,+1)&#39;], dtype=&#39;&lt;U7&#39;)
</pre></div></div>
</div>
<div class="section" id="Metropolis">
<h3>Metropolis<a class="headerlink" href="#Metropolis" title="Permalink to this headline">¶</a></h3>
<p>An alternative approach is provided by the Metropolis-Hastings algorithm. It is based on Markov chains and uses an equilibrium condition called detailed balance to prove a simple assumption: If the system is in a state with energy <span class="math notranslate nohighlight">\(E_0\)</span> and we flip the spin of a single randomly selected element so that the system now has <span class="math notranslate nohighlight">\(E_1\)</span>, the probability to accept that change should be:</p>
<div class="math notranslate nohighlight">
\[p=min(1,\exp(-\Delta E \beta)) \qquad \mathrm{with}\quad \Delta E=E_1 - E_0\]</div>
<p>In other words, if we start in a high energy state then we will always flip into a low energy state. If we are in a lower energy state there is some small chance of flipping into a high energy state. This “uphill” transition is more likely for higher temperatures and less likely for low temperatures.</p>
<div class="section" id="Question:-Use-the-metropolis-algorithm-to-generate-a-sequence-of-states-for-a-single-dipole-with-T=300K,-dE=0.01,-0.1,-1,-10eV.-Calculate-the-expected-probabilities-for-each-state-and-compare-to-the-computed-results-for-1000-iterations.">
<h4>Question: Use the metropolis algorithm to generate a sequence of states for a single dipole with T=300K, dE=0.01, 0.1, 1, 10eV. Calculate the expected probabilities for each state and compare to the computed results for 1000 iterations.<a class="headerlink" href="#Question:-Use-the-metropolis-algorithm-to-generate-a-sequence-of-states-for-a-single-dipole-with-T=300K,-dE=0.01,-0.1,-1,-10eV.-Calculate-the-expected-probabilities-for-each-state-and-compare-to-the-computed-results-for-1000-iterations." title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;$\Delta E [J/k_B]$&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Probability&quot;</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Metropolis acceptance probability&quot;</span><span class="p">)</span>
<span class="n">dE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">T</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dE</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)),</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">beta$=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/JupyterNotes_phys481_week06_ising_model-notes_15_0.png" src="../_images/JupyterNotes_phys481_week06_ising_model-notes_15_0.png" />
</div>
</div>
</div>
</div>
</div>
<div class="section" id="Interacting-1D">
<h2>Interacting 1D<a class="headerlink" href="#Interacting-1D" title="Permalink to this headline">¶</a></h2>
<p>Each dipole will generate a (small) magnetic field that may influence other dipoles. We can explore this possibility by arranging a number of binary spins <span class="math notranslate nohighlight">\(S_k\)</span> in a row (or a ring) and then introduce a weak coupling term</p>
<div class="math notranslate nohighlight">
\[E_i = -J \,S_{i-1} S_i - J \,S_{i+1} S_i
 = -J \sum_j S_i S_j  \qquad j=i+1, i-1\]</div>
<p>that can only affect the two nearest neighbors.</p>
<p><em>Note</em> - there may also be a background field <span class="math notranslate nohighlight">\(B\)</span> that must be taken into account.</p>
</div>
<div class="section" id="2-D-Ising-model">
<h2>2-D Ising model<a class="headerlink" href="#2-D-Ising-model" title="Permalink to this headline">¶</a></h2>
<p>Read the notes in D2L: Ising_Model_MIT_Notes.pdf</p>
<p>Read through this jupyter notebook:</p>
<p><a class="reference external" href="http://nbviewer.jupyter.org/github/s9w/magneto/blob/master/physics.ipynb">http://nbviewer.jupyter.org/github/s9w/magneto/blob/master/physics.ipynb</a></p>
<p>Consider a square lattice of N sites, each containing a spin <span class="math notranslate nohighlight">\(S_n\)</span> where <span class="math notranslate nohighlight">\(n=1,\ldots,N\)</span>. Each spin can be either “up” (<span class="math notranslate nohighlight">\(S_n = +1\)</span>) or down (<span class="math notranslate nohighlight">\(S_n=-1\)</span>). Each spin interacts magnetically with its nearest four neighbors (above, below, left, right) and with an external magnetic field (if present). The Hamiltonian for this Ising model is</p>
<div class="math notranslate nohighlight">
\[E(S_1,\ldots,S_N) = -J \sum_{i,j} S_i S_j - B \sum_k S_k\]</div>
<p>where the interaction sum <span class="math notranslate nohighlight">\(i,j\)</span> is over the four nearest-neighbour pairs of spins ie. <span class="math notranslate nohighlight">\(S_{ij}\)</span> interacts with <span class="math notranslate nohighlight">\(S_{i\pm 1,j}\)</span> and <span class="math notranslate nohighlight">\(S_{i,j \pm 1}\)</span> and the diagonal neighbors are ignored.</p>
<div class="section" id="Stochastic">
<h3>Stochastic<a class="headerlink" href="#Stochastic" title="Permalink to this headline">¶</a></h3>
<p>Any randomly created lattice will have some total energy <span class="math notranslate nohighlight">\(E\)</span>. Flipping a single electron might require adding or removing a tiny bit of energy <span class="math notranslate nohighlight">\(dE\)</span>. If the lattice is in thermal equilibrium with a “heat-sink” of temperature T, then the probability of states should be Boltzman distributed</p>
<div class="math notranslate nohighlight">
\[p(\mathbf x) \propto \exp(-\frac{E(\mathbf x)}{k_B T})\]</div>
<p>and the relative probability of two different states is</p>
<div class="math notranslate nohighlight">
\[r = \frac{p_2}{p_1} = e^{(E_2-E_1)/k_B T}\]</div>
<p>If we only consider the effect of a single flip <span class="math notranslate nohighlight">\(S_n\)</span>, then</p>
<div class="math notranslate nohighlight">
\[r = e^{-2 S_n (J f + B) / k_B T}\]</div>
<p>where all the information about neighbors is gathered into a single term</p>
<div class="math notranslate nohighlight">
\[f = S_{i+1,j} + S_{i-1,j} + S_{i,j+1} + S_{i,j-1}\]</div>
<p>with only five possible values (<span class="math notranslate nohighlight">\(0, \pm 2, \pm 4\)</span>). With two possible values of <span class="math notranslate nohighlight">\(S_n\)</span> there are only 10 possible values for <span class="math notranslate nohighlight">\(r\)</span>, so we could compute these once at the beginning of the program in order to avoid re-calculating the same computationally expensive exponentials over and over.</p>
<div class="section" id="Task-3.1:-Write-python-code-to-implement-the-Ising-model-on-a-51x49-grid-for-arbitrary-J-and-B.-Use-200-sweeps-to-thermalize-and-assume-that-the-grid-is-randomized-after-20-sweeps.">
<h4>Task 3.1: Write python code to implement the Ising model on a 51x49 grid for arbitrary J and B. Use 200 sweeps to thermalize and assume that the grid is randomized after 20 sweeps.<a class="headerlink" href="#Task-3.1:-Write-python-code-to-implement-the-Ising-model-on-a-51x49-grid-for-arbitrary-J-and-B.-Use-200-sweeps-to-thermalize-and-assume-that-the-grid-is-randomized-after-20-sweeps." title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="Task-3.2:-Produce-grid-plots-(ie.-matplotlib-imshow)-for-B=0,-B=+0.5,-B=-0.5-with-J=(kB-T)">
<h4>Task 3.2: Produce grid plots (ie. matplotlib imshow) for B=0, B=+0.5, B=-0.5 with J=(kB T)<a class="headerlink" href="#Task-3.2:-Produce-grid-plots-(ie.-matplotlib-imshow)-for-B=0,-B=+0.5,-B=-0.5-with-J=(kB-T)" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="Task-3.3:-For-B=0-and-J/(T-kB)=range(0.0,-0.6,-21),-calculate-and-plot-the-average-magnetization-M-versus-J/TkB.">
<h4>Task 3.3: For B=0 and J/(T kB)=range(0.0, 0.6, 21), calculate and plot the average magnetization M versus J/TkB.<a class="headerlink" href="#Task-3.3:-For-B=0-and-J/(T-kB)=range(0.0,-0.6,-21),-calculate-and-plot-the-average-magnetization-M-versus-J/TkB." title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="Task-3.4:-Produce-a-hysteresis-curve-over-an-appropriate-range-of-external-magnetic-field-B-values.">
<h4>Task 3.4: Produce a hysteresis curve over an appropriate range of external magnetic field B values.<a class="headerlink" href="#Task-3.4:-Produce-a-hysteresis-curve-over-an-appropriate-range-of-external-magnetic-field-B-values." title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="Task-3.5:-Produce-a-grid-plot-for-J=-kB-T.">
<h4>Task 3.5: Produce a grid plot for J=-kB T.<a class="headerlink" href="#Task-3.5:-Produce-a-grid-plot-for-J=-kB-T." title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="Task-3.6:-Briefly-discuss-all-of-your-results.">
<h4>Task 3.6: Briefly discuss all of your results.<a class="headerlink" href="#Task-3.6:-Briefly-discuss-all-of-your-results." title="Permalink to this headline">¶</a></h4>
</div>
</div>
</div>
<div class="section" id="id1">
<h2>Ising model<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Some of the following code may be a useful guide when writing your own, but should not simply be used without thinking it through very carefully.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline


<span class="k">def</span> <span class="nf">spinflip</span><span class="p">(</span><span class="n">nearspins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    what should this docstring say?</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nspins</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nearspins</span><span class="p">)</span>   <span class="c1">#; print(nspins)</span>
    <span class="n">local_field</span> <span class="o">=</span> <span class="n">J</span><span class="o">*</span><span class="n">nearspins</span> <span class="o">+</span> <span class="n">B</span>

    <span class="n">probability_plus</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">local_field</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">spin_up</span> <span class="o">=</span> <span class="n">probability_plus</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nspins</span><span class="p">)</span>

    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">spin_up</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="c1">#-------------------------------------------------------</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">ising_step</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">nsites</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Pick one or more sites at random, count the neighbours,</span>
<span class="sd">    and apply flips.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1"># pick some random grid location(s)</span>
    <span class="n">xx</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nsites</span><span class="p">)</span><span class="o">*</span><span class="n">nx</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
    <span class="n">yy</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nsites</span><span class="p">)</span><span class="o">*</span><span class="n">ny</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>

    <span class="c1"># count neighboring spins, taking care to wrap as needed</span>
    <span class="n">nn</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span class="n">xx</span><span class="p">,(</span><span class="n">yy</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">ny</span>] + grid[xx,yy-1] + grid[(xx+1)%nx,yy] + grid[xx-1,yy]
    <span class="n">grid</span><span class="p">[</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">]</span> <span class="o">=</span> <span class="n">spinflip</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">grid</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1">#----------------------------------------------------</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">ising_model</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">nsites</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">grid</span><span class="o">.</span><span class="n">size</span> <span class="p">)</span>

    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
        <span class="n">ims</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>

    <span class="n">M</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># magnetization</span>
    <span class="k">for</span> <span class="n">indx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsteps</span><span class="p">):</span>
        <span class="n">M</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span> <span class="p">)</span>

        <span class="c1"># successive grids may be corelated, so skip a few</span>
        <span class="k">for</span> <span class="n">nsteps</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="n">ising_step</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">nsites</span><span class="o">=</span><span class="n">nsites</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
            <span class="n">ims</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span> <span class="c1">#; print(np.sum(grid)/grid.size)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span> <span class="p">;</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span> <span class="p">;</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">grid</span><span class="p">,</span> <span class="n">M</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Elijah Thompson.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>